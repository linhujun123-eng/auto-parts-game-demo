<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éƒ¨ä»¶å¯»å®å¤§å†’é™© Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial Rounded MT Bold', 'Arial', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }
        
        .game-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        
        /* é¡¶éƒ¨çŠ¶æ€æ  */
        .status-bar {
            background: linear-gradient(to right, #4299e1, #3182ce);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .player-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .gear-count {
            font-size: 24px;
            font-weight: bold;
            color: #f6ad55;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        /* æ¸¸æˆä¸»åŒºåŸŸ */
        .game-area {
            padding: 20px;
            min-height: 500px;
            background: linear-gradient(180deg, #ebf8ff 0%, #e6fffa 100%);
        }
        
        .scene-title {
            text-align: center;
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 28px;
        }
        
        .engine-scene {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .engine-part {
            background: white;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 3px solid transparent;
        }
        
        .engine-part:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
            border-color: #4299e1;
        }
        
        .engine-part.completed {
            border-color: #48bb78;
            background: #f0fff4;
        }
        
        .part-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }
        
        .part-name {
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 5px;
        }
        
        .part-desc {
            font-size: 12px;
            color: #718096;
        }
        
        /* ä»»åŠ¡åˆ—è¡¨ */
        .task-list {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        
        .task-item {
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 10px;
            border-left: 4px solid #cbd5e0;
            transition: all 0.3s ease;
        }
        
        .task-item.current {
            background: #ebf8ff;
            border-left-color: #4299e1;
        }
        
        .task-item.completed {
            background: #f0fff4;
            border-left-color: #48bb78;
        }
        
        /* äº¤äº’é¢æ¿ */
        .interaction-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .interaction-panel.active {
            opacity: 1;
            visibility: visible;
        }
        
        .panel-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            text-align: center;
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }
        
        .interaction-panel.active .panel-content {
            transform: translateY(0);
        }
        
        .swipe-track {
            width: 100%;
            height: 60px;
            background: #e2e8f0;
            border-radius: 30px;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
        }
        
        .swipe-handle {
            position: absolute;
            left: 5px;
            top: 5px;
            width: 50px;
            height: 50px;
            background: #4299e1;
            border-radius: 25px;
            cursor: grab;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }
        
        .swipe-text {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #718096;
        }
        
        .knowledge-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }
        
        /* æŒ‰é’® */
        .btn {
            background: #4299e1;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }
        
        .btn:hover {
            background: #3182ce;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: #48bb78;
        }
        
        .btn-success:hover {
            background: #38a169;
        }
        
        /* åŠ¨ç”» */
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .floating {
            animation: float 2s ease-in-out infinite;
        }
        
        @keyframes celebrate {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        .celebrate {
            animation: celebrate 0.5s ease-in-out;
        }
        
        /* å“åº”å¼ */
        @media (max-width: 600px) {
            .engine-scene {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- é¡¶éƒ¨çŠ¶æ€æ  -->
        <div class="status-bar">
            <div class="player-info">
                <div>ğŸ‘¦ å°å°æœºæ¢°å¸ˆ</div>
                <div class="gear-count">çŸ¥è¯†é½¿è½®: <span id="gearCount">0</span></div>
            </div>
            <div>ç¬¬ä¸€å…³ï¼šå¼•æ“åŸå ¡</div>
        </div>
        
        <!-- æ¸¸æˆä¸»åŒºåŸŸ -->
        <div class="game-area">
            <h2 class="scene-title">ğŸš— å¼•æ“åŸå ¡å¤§å†’é™©</h2>
            
            <!-- ä»»åŠ¡åˆ—è¡¨ -->
            <div class="task-list">
                <h3>ğŸ“‹ å½“å‰ä»»åŠ¡</h3>
                <div id="taskList">
                    <!-- ä»»åŠ¡ä¼šåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
            
            <!-- å¼•æ“åœºæ™¯ -->
            <div class="engine-scene" id="engineScene">
                <!-- éƒ¨ä»¶ä¼šåŠ¨æ€ç”Ÿæˆ -->
            </div>
            
            <!-- å®Œæˆæç¤º -->
            <div id="completionMessage" style="text-align: center; display: none;">
                <div class="knowledge-card">
                    <h3>ğŸ‰ æ­å–œï¼ç¬¬ä¸€å…³å®Œæˆï¼</h3>
                    <p>ä½ æˆåŠŸä¿®å¤äº†å¼•æ“åŸå ¡ï¼Œè·å¾—äº† <span id="finalGears">0</span> ä¸ªçŸ¥è¯†é½¿è½®ï¼</p>
                    <button class="btn btn-success" onclick="restartGame()">å†ç©ä¸€æ¬¡</button>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 30px; color: #718096; font-size: 14px;">
                <p>ğŸ’¡ æç¤ºï¼šç‚¹å‡»ä¸åŒçš„æ±½è½¦éƒ¨ä»¶å¼€å§‹å­¦ä¹ å§ï¼</p>
            </div>
        </div>
    </div>
    
    <!-- äº¤äº’é¢æ¿ -->
    <div class="interaction-panel" id="interactionPanel">
        <div class="panel-content" id="panelContent">
            <!-- å†…å®¹ä¼šåŠ¨æ€ç”Ÿæˆ -->
        </div>
    </div>
    
    <script>
        // æ¸¸æˆæ•°æ®
        const gameData = {
            gears: 0,
            currentTask: 0,
            tasks: [
                {
                    id: 'hood',
                    name: 'æ‰“å¼€å¼•æ“ç›–',
                    description: 'æ»‘åŠ¨è§£é”å¼•æ“ç›–',
                    completed: false,
                    type: 'swipe',
                    icon: 'ğŸšª',
                    partName: 'å¼•æ“ç›–',
                    pinyin: 'yÇn qÃ­ng gÃ i',
                    function: 'ä¿æŠ¤å‘åŠ¨æœºèˆ±çš„"å®‰å…¨é—¨"ï¼Œé˜²æ­¢ç°å°˜å’Œæ°´è¿›å…¥',
                    funFact: 'æœ€æ—©çš„æ±½è½¦æ²¡æœ‰å¼•æ“ç›–ï¼Œå‘åŠ¨æœºå®Œå…¨æš´éœ²åœ¨å¤–ï¼'
                },
                {
                    id: 'battery',
                    name: 'æ‰¾åˆ°ç”µæ± ',
                    description: 'ç‚¹å‡»å‘ç°æ±½è½¦ç”µæ± ',
                    completed: false,
                    type: 'click',
                    icon: 'ğŸ”‹',
                    partName: 'ç”µæ± ',
                    pinyin: 'diÃ n chÃ­',
                    function: 'æ±½è½¦çš„"èƒ½é‡å¿ƒè„"ï¼Œä¸ºæ‰€æœ‰ç”µå­è®¾å¤‡ä¾›ç”µ',
                    funFact: 'æ±½è½¦ç”µæ± ç”µå‹æ˜¯12Vï¼Œæ¯”ç©å…·ç”µæ± çš„1.5Vå¼º8å€ï¼'
                },
                {
                    id: 'air_filter',
                    name: 'æ¸…æ´ç©ºæ°”æ»¤æ¸…å™¨',
                    description: 'æ‹–æ‹½æ¸…æ´å·¥å…·',
                    completed: false,
                    type: 'drag',
                    icon: 'ğŸŒ€',
                    partName: 'ç©ºæ°”æ»¤æ¸…å™¨',
                    pinyin: 'kÅng qÃ¬ lÇœ qÄ«ng qÃ¬',
                    function: 'å‘åŠ¨æœºçš„"å£ç½©"ï¼Œè¿‡æ»¤ç©ºæ°”ä¸­çš„ç°å°˜',
                    funFact: 'å¦‚æœä¸æ¸…æ´ï¼Œæ»¤æ¸…å™¨å¯èƒ½ä¼šè¢«ç°å°˜å®Œå…¨å µä½ï¼'
                },
                {
                    id: 'radiator',
                    name: 'ç»™æ°´ç®±åŠ æ°´',
                    description: 'ç‚¹å‡»æ°´å£¶ç»™æ°´ç®±åŠ æ°´',
                    completed: false,
                    type: 'pour',
                    icon: 'ğŸ’§',
                    partName: 'æ°´ç®±',
                    pinyin: 'shuÇ xiÄng',
                    function: 'å‘åŠ¨æœºçš„"ç©ºè°ƒ"ï¼Œé˜²æ­¢è¿‡çƒ­',
                    funFact: 'æ°´ç®±é‡Œçš„æ°´ä¸æ˜¯æ™®é€šæ°´ï¼Œæ˜¯ç‰¹æ®Šçš„å†·å´æ¶²ï¼'
                },
                {
                    id: 'engine',
                    name: 'å¯åŠ¨å¼•æ“',
                    description: 'æŒ‰æ­£ç¡®é¡ºåºå¯åŠ¨',
                    completed: false,
                    type: 'sequence',
                    icon: 'âš™ï¸',
                    partName: 'å‘åŠ¨æœº',
                    pinyin: 'fÄ dÃ²ng jÄ«',
                    function: 'æ±½è½¦çš„"å¿ƒè„"ï¼ŒæŠŠç‡ƒæ–™å˜æˆåŠ¨åŠ›',
                    funFact: 'å‘åŠ¨æœºæ¯åˆ†é’Ÿå¯ä»¥è½¬åŠ¨å‡ åƒæ¬¡ï¼'
                }
            ]
        };

        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            updateTaskList();
            createEngineScene();
            updateGearDisplay();
        }

        // æ›´æ–°ä»»åŠ¡åˆ—è¡¨æ˜¾ç¤º
        function updateTaskList() {
            const taskList = document.getElementById('taskList');
            taskList.innerHTML = '';
            
            gameData.tasks.forEach((task, index) => {
                const taskDiv = document.createElement('div');
                taskDiv.className = `task-item ${index === gameData.currentTask ? 'current' : ''} ${task.completed ? 'completed' : ''}`;
                taskDiv.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span style="color: ${task.completed ? '#48bb78' : '#718096'}">
                            ${task.completed ? 'âœ…' : `${index + 1}.`}
                        </span>
                        <span style="font-weight: ${index === gameData.currentTask ? 'bold' : 'normal'}">
                            ${task.name}
                        </span>
                    </div>
                    ${!task.completed && index === gameData.currentTask ? 
                        `<div style="font-size: 12px; color: #718096; margin-top: 5px;">
                            ${task.description}
                        </div>` : ''
                    }
                `;
                taskList.appendChild(taskDiv);
            });
        }

        // åˆ›å»ºå¼•æ“åœºæ™¯
        function createEngineScene() {
            const engineScene = document.getElementById('engineScene');
            engineScene.innerHTML = '';
            
            gameData.tasks.forEach((task, index) => {
                const partDiv = document.createElement('div');
                partDiv.className = `engine-part ${task.completed ? 'completed' : ''}`;
                partDiv.innerHTML = `
                    <div class="part-icon">${task.icon}</div>
                    <div class="part-name">${task.partName}</div>
                    <div class="part-desc">${task.completed ? 'å·²å®Œæˆ' : 'ç‚¹å‡»å­¦ä¹ '}</div>
                `;
                
                partDiv.onclick = () => {
                    if (index === gameData.currentTask) {
                        startInteraction(task);
                    } else if (index < gameData.currentTask) {
                        showKnowledgeCard(task);
                    }
                };
                
                engineScene.appendChild(partDiv);
            });
        }

        // å¼€å§‹äº¤äº’
        function startInteraction(task) {
            const panel = document.getElementById('interactionPanel');
            const content = document.getElementById('panelContent');
            
            panel.classList.add('active');
            
            if (task.type === 'swipe') {
                content.innerHTML = `
                    <h2>æ»‘åŠ¨è§£é”å¼•æ“ç›–</h2>
                    <p>å‘å³æ»‘åŠ¨æŠŠæ‰‹æ¥æ‰“å¼€å¼•æ“ç›–</p>
                    
                    <div class="swipe-track" id="swipeTrack">
                        <div class="swipe-handle" id="swipeHandle">â†’</div>
                        <div class="swipe-text">å‘å³æ»‘åŠ¨è§£é”</div>
                    </div>
                    
                    <button class="btn" onclick="closePanel()">å–æ¶ˆ</button>
                `;
                
                setTimeout(() => {
                    setupSwipeInteraction(task);
                }, 100);
            } else if (task.type === 'click') {
                content.innerHTML = `
                    <h2>æ‰¾åˆ°ç”µæ± </h2>
                    <p>ç‚¹å‡»ä¸‹é¢çš„ç”µæ± æ¥å‘ç°å®ƒ</p>
                    
                    <div style="font-size: 60px; margin: 30px 0; cursor: pointer;" 
                         onclick="completeTask('${task.id}')" class="floating">
                        ğŸ”‹
                    </div>
                    
                    <p>ç”µæ± åœ¨å“ªé‡Œï¼Ÿé€šå¸¸åœ¨å¼•æ“èˆ±çš„è§’è½</p>
                    <button class="btn" onclick="closePanel()">å–æ¶ˆ</button>
                `;
            } else if (task.type === 'drag') {
                content.innerHTML = `
                    <h2>æ¸…æ´ç©ºæ°”æ»¤æ¸…å™¨</h2>
                    <p>æ‹–æ‹½æ¸…æ´å·¥å…·æ¥æ¸…æ´æ»¤æ¸…å™¨</p>
                    
                    <div style="position: relative; height: 200px; margin: 20px 0;">
                        <div style="position: absolute; left: 50px; top: 50px; font-size: 40px;">
                            ğŸŒ€
                        </div>
                        <div id="cleanTool" 
                             style="position: absolute; left: 300px; top: 50px; font-size: 40px; cursor: grab;">
                            ğŸ§¹
                        </div>
                    </div>
                    
                    <p>æŠŠæ¸…æ´å·¥å…·æ‹–åˆ°æ»¤æ¸…å™¨ä¸Š</p>
                    <button class="btn" onclick="completeTask('${task.id}')">æˆ‘å·²ç»æ¸…æ´äº†</button>
                    <button class="btn" onclick="closePanel()">å–æ¶ˆ</button>
                `;
                
                setTimeout(() => {
                    setupDragInteraction();
                }, 100);
            } else {
                content.innerHTML = `
                    <h2>å­¦ä¹ ï¼š${task.partName}</h2>
                    <p>ç‚¹å‡»æŒ‰é’®å®Œæˆè¿™ä¸ªä»»åŠ¡</p>
                    <button class="btn" onclick="completeTask('${task.id}')">æˆ‘çŸ¥é“äº†ï¼</button>
                    <button class="btn" onclick="closePanel()">å–æ¶ˆ</button>
                `;
            }
        }

        // è®¾ç½®æ»‘åŠ¨äº¤äº’
        function setupSwipeInteraction(task) {
            const handle = document.getElementById('swipeHandle');
            const track = document.getElementById('swipeTrack');
            
            let isDragging = false;
            let startX = 0;
            const trackWidth = track.offsetWidth - 60;
            
            handle.addEventListener('mousedown', startDrag);
            handle.addEventListener('touchstart', startDrag);
            
            function startDrag(e) {
                isDragging = true;
                startX = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
                handle.style.cursor = 'grabbing';
                document.addEventListener('mousemove', drag);
                document.addEventListener('touchmove', drag);
                document.addEventListener('mouseup', endDrag);
                document.addEventListener('touchend', endDrag);
            }
            
            function drag(e) {
                if (!isDragging) return;
                
                e.preventDefault();
                const clientX = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
                const deltaX = clientX - startX;
                const newX = Math.max(5, Math.min(trackWidth, deltaX));
                
                handle.style.left = `${newX}px`;
                
                // å¦‚æœæ»‘åˆ°ç»ˆç‚¹
                if (newX >= trackWidth - 10) {
                    completeTask(task.id);
                    endDrag();
                }
            }
            
            function endDrag() {
                isDragging = false;
                handle.style.cursor = 'grab';
                handle.style.left = '5px';
                
                document.removeEventListener('mousemove', drag);
                document.removeEventListener('touchmove', drag);
                document.removeEventListener('mouseup', endDrag);
                document.removeEventListener('touchend', endDrag);
            }
        }

        // è®¾ç½®æ‹–æ‹½äº¤äº’
        function setupDragInteraction() {
            const tool = document.getElementById('cleanTool');
            let isDragging = false;
            
            tool.addEventListener('mousedown', () => {
                isDragging = true;
                tool.style.cursor = 'grabbing';
                tool.textContent = 'ğŸ§½'; // æ¸…æ´ä¸­
            });
            
            document.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                
                const rect = document.querySelector('.panel-content').getBoundingClientRect();
                tool.style.left = `${e.clientX - rect.left - 20}px`;
                tool.style.top = `${e.clientY - rect.top - 20}px`;
                
                // æ£€æŸ¥æ˜¯å¦æ‹–åˆ°äº†æ»¤æ¸…å™¨ä½ç½®
                const filterX = 50, filterY = 50;
                const toolX = e.clientX - rect.left;
                const toolY = e.clientY - rect.top;
                
                const distance = Math.sqrt(
                    Math.pow(toolX - filterX, 2) + Math.pow(toolY - filterY, 2)
                );
                
                if (distance < 50) {
                    tool.textContent = 'âœ¨'; // æ¸…æ´å®Œæˆ
                    setTimeout(() => {
                        completeTask('air_filter');
                    }, 500);
                }
            });
            
            document.addEventListener('mouseup', () => {
                isDragging = false;
                tool.style.cursor = 'grab';
            });
        }

        // å®Œæˆä»»åŠ¡
        function completeTask(taskId) {
            const taskIndex = gameData.tasks.findIndex(t => t.id === taskId);
            
            if (taskIndex >= 0 && !gameData.tasks[taskIndex].completed) {
                // æ ‡è®°ä»»åŠ¡å®Œæˆ
                gameData.tasks[taskIndex].completed = true;
                
                // å¥–åŠ±é½¿è½®
                gameData.gears += 1;
                
                // æ›´æ–°å½“å‰ä»»åŠ¡
                if (taskIndex === gameData.currentTask) {
                    gameData.currentTask++;
                    
                    // æ˜¾ç¤ºçŸ¥è¯†å¡ç‰‡
                    showKnowledgeCard(gameData.tasks[taskIndex]);
                }
                
                // æ›´æ–°æ˜¾ç¤º
                updateTaskList();
                createEngineScene();
                updateGearDisplay();
                
                // æ’­æ”¾åº†ç¥æ•ˆæœ
                celebrateCompletion();
                
                // æ£€æŸ¥æ˜¯å¦å®Œæˆæ‰€æœ‰ä»»åŠ¡
                if (gameData.tasks.every(t => t.completed)) {
                    showCompletionMessage();
                }
                
                // å…³é—­é¢æ¿
                closePanel();
            }
        }

        // æ˜¾ç¤ºçŸ¥è¯†å¡ç‰‡
        function showKnowledgeCard(task) {
            const panel = document.getElementById('interactionPanel');
            const content = document.getElementById('panelContent');
            
            panel.classList.add('active');
            content.innerHTML = `
                <div class="knowledge-card">
                    <h2 style="margin-bottom: 10px;">âœ¨ æ–°çŸ¥è¯†è§£é”ï¼</h2>
                    <div style="font-size: 40px; margin: 10px 0;">${task.icon}</div>
                    <h3>${task.partName} <small style="opacity: 0.8;">${task.pinyin}</small></h3>
                    <p style="margin: 10px 0;">${task.function}</p>
                    <div style="background: rgba(255, 255, 255, 0.2); padding: 10px; border-radius: 10px; margin: 15px 0;">
                        <strong>ğŸ’¡ è¶£å‘³çŸ¥è¯†</strong>
                        <p style="margin-top: 5px;">${task.funFact}</p>
                    </div>
                    <button class="btn" onclick="closePanel()">å¤ªæ£’äº†ï¼ç»§ç»­å­¦ä¹ </button>
                </div>
            `;
        }

        // æ˜¾ç¤ºå®Œæˆæ¶ˆæ¯
        function showCompletionMessage() {
            setTimeout(() => {
                document.getElementById('finalGears').textContent = gameData.gears;
                document.getElementById('completionMessage').style.display = 'block';
                
                // åº†ç¥æ•ˆæœ
                for (let i = 0; i < 10; i++) {
                    createConfetti();
                }
            }, 1000);
        }

        // åº†ç¥æ•ˆæœ
        function celebrateCompletion() {
            // é½¿è½®è®¡æ•°åŠ¨ç”»
            const gearCount = document.getElementById('gearCount');
            gearCount.classList.add('celebrate');
            setTimeout(() => {
                gearCount.classList.remove('celebrate');
            }, 500);
        }

        // åˆ›å»ºå½©èŠ±æ•ˆæœ
        function createConfetti() {
            const confetti = document.createElement('div');
            confetti.innerHTML = ['ğŸ‰', 'âœ¨', 'ğŸŠ', 'â­', 'âš™ï¸'][Math.floor(Math.random() * 5)];
            confetti.style.cssText = `
                position: fixed;
                top: -50px;
                left: ${Math.random() * 100}%;
                font-size: 20px;
                z-index: 1000;
                animation: fall linear forwards;
            `;
            
            // éšæœºåŠ¨ç”»
            const duration = 1 + Math.random() * 2;
            const xOffset = (Math.random() - 0.5) * 200;
            
            confetti.style.animation = `
                fall ${duration}s linear forwards,
                spin ${duration * 0.5}s linear infinite
            `;
            
            confetti.style.setProperty('--x-offset', `${xOffset}px`);
            
            document.body.appendChild(confetti);
            
            setTimeout(() => {
                confetti.remove();
            }, duration * 1000);
        }

        // å…³é—­é¢æ¿
        function closePanel() {
            document.getElementById('interactionPanel').classList.remove('active');
        }

        // æ›´æ–°é½¿è½®æ˜¾ç¤º
        function updateGearDisplay() {
            document.getElementById('gearCount').textContent = gameData.gears;
        }

        // é‡æ–°å¼€å§‹æ¸¸æˆ
        function restartGame() {
            gameData.gears = 0;
            gameData.currentTask = 0;
            gameData.tasks.forEach(task => {
                task.completed = false;
            });
            
            document.getElementById('completionMessage').style.display = 'none';
            initGame();
        }

        // åˆå§‹åŒ–æ¸¸æˆ
        initGame();
        
        // æ·»åŠ CSSåŠ¨ç”»
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fall {
                0% {
                    transform: translateY(0) translateX(0);
                    opacity: 1;
                }
                100% {
                    transform: translateY(100vh) translateX(var(--x-offset, 0));
                    opacity: 0;
                }
            }
            
            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>